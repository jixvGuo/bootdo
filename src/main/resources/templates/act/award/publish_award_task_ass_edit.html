<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">
<meta charset="utf-8">
<head th:include="include :: header"></head>
<body class="gray-bg">
<div class="wrapper wrapper-content">
    <div class="row">
        <div class="col-sm-12">
            <div class="ibox float-e-margins">
                <div class="ibox-content">
                    <form class="form-horizontal m-t" id="signupForm" enctype="multipart/form-data">
                        <input id="id" name="id" th:value="${awardTask.id}" type="hidden">

                        <div class="form-group">
                            <label class="col-sm-1 control-label">标题：</label>
                            <div class="col-sm-4">
                                <input id="taskName" placeholder="标题" autocomplete="off"
                                       th:value="${awardTask.taskName}" name="taskName" class="form-control"
                                       type="text">
                            </div>
                        </div>


                        <div class="form-group">
                            <label class="col-sm-1 control-label">协会联系人：</label>
                            <div class="col-sm-4">
                                <select id="associationUserId" title="请选择协会负责人" name="associationUserId"
                                        class="selectpicker" data-live-search="true">
                                    <!--<option th:each="association:${associationUsers}"    th:value="${association.userId}"-->
                                    <!--th:text="${association.name}"></option>-->

                                    <!--th:value = ""-->
                                    <option th:selected="${awardTask.associationUserId == association.userId}"
                                            th:each="association:${associationUsers}"
                                            th:value="${association.userId}" th:text="${association.name}"></option>
                                    <input type="hidden" th:value="${awardTask.associationUserId}" id="associationUid"/>
                                </select>
                                <span class="help-block m-b-none"><i
                                        class="fa fa-info-circle"></i> 这里从协会人员库里选择负责人</span>
                            </div>

                            <label class="col-sm-1 control-label">任务申报阶段：</label>
                            <div class="col-sm-4">
                                <input placeholder="开始日期" class="form-control layer-date" autocomplete="off"
                                       th:value="${#dates.format(awardTask.applyStartDate,'YYYY-MM-dd HH:mm')}"
                                       id="task_start_time">
                                <input placeholder="结束日期" class="form-control layer-date" autocomplete="off"
                                       th:value="${#dates.format(awardTask.applyEndDate,'YYYY-MM-dd HH:mm')}"
                                       id="task_end_time">
                            </div>

                        </div>


                        <div class="form-group">
                            <label class="col-sm-1 control-label">形式审查阶段：</label>
                            <div class="col-sm-4">
                                <input placeholder="开始日期" class="form-control layer-date" autocomplete="off"
                                       th:value="${#dates.format(awardTask.checkStartTime,'YYYY-MM-dd HH:mm')}"
                                       id="check_start_time">
                                <input placeholder="结束日期" class="form-control layer-date" autocomplete="off"
                                       th:value="${#dates.format(awardTask.checkEndTime,'YYYY-MM-dd HH:mm')}"
                                       id="check_end_time">
                            </div>
                            <div th:if="${type} eq '2'">
                                <input type="hidden" name="expertStartTime" />
                                <input type="hidden" name="expertEndTime" />
                            </div>
                            <label th:if="${type} eq '1' or ${type} eq '2'" class="col-sm-1 control-label">专家审查阶段：</label>
                            <div th:if="${type} eq '1' or ${type} eq '2'" class="col-sm-4">
                                <input placeholder="开始日期" autocomplete="off" class="form-control layer-date"
                                       th:value="${#dates.format(awardTask.expertStartTime,'YYYY-MM-dd HH:mm')}"
                                       id="expert_start_time" name="expertStartTime">
                                <input placeholder="结束日期" autocomplete="off" class="form-control layer-date"
                                       th:value="${#dates.format(awardTask.expertEndTime,'YYYY-MM-dd HH:mm')}"
                                       id="expert_end_time" name="expertEndTime">
                            </div>
                        </div>

                        <div th:if="${type} eq '3' or ${type} eq '5'"  class="form-group">
                            <label class="col-sm-1 control-label">第一阶段专家评审：</label>
                            <div class="col-sm-4">
                                <input placeholder="开始日期" autocomplete="off" class="form-control layer-date"
                                       th:value="${#dates.format(awardTask.expertStartTime,'YYYY-MM-dd HH:mm')}"
                                       id="expert_start_time" name="expertStartTime">
                                <input placeholder="结束日期" autocomplete="off" class="form-control layer-date"
                                       th:value="${#dates.format(awardTask.expertEndTime,'YYYY-MM-dd HH:mm')}"
                                       id="expert_end_time" name="expertEndTime">
                            </div>

                            <label class="col-sm-1 control-label">第二阶段专家评审：</label>
                            <div class="col-sm-4">
                                <input placeholder="开始日期" autocomplete="off" class="form-control layer-date"
                                       th:value="${#dates.format(awardTask.expertStartTimeSecond,'YYYY-MM-dd HH:mm')}"
                                       id="expert_start_time_second" name="expertStartTimeSecond">
                                <input placeholder="结束日期" autocomplete="off" class="form-control layer-date"
                                       th:value="${#dates.format(awardTask.expertEndTimeSecond,'YYYY-MM-dd HH:mm')}"
                                       id="expert_end_time_second" name="expertEndTimeSecond">
                            </div>
                        </div>


                        <div class="form-group">
                            <input id="content" name="content" type="hidden"> <label
                                class="col-sm-1 control-label">评审要求：</label>
                            <div class="col-sm-8">
                                <textarea id="editor" placeholder="这里输入内容" th:text="${awardTask.validateRequire}"
                                          autofocus></textarea>
                            </div>
                        </div>

                        <div id="task_file" style="display:block; margin-top: 20px" class="updocss_b col-sm-9">
                            <div class="ibox float-e-margins">
                                <div class="ibox-content">
                                    <button type="button" onclick="openUpload()" style="width: 100%"
                                            class="btn btn-primary" fileType="task_file">
                                        上传文件
                                    </button>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12" id="upload_div">

                                    <div th:each="doc:${docUploadDoList}" th:if="${doc.fileType} eq 'task_file'"
                                         class="file-box">
                                        <div class="file">
                                            <input type="hidden" name="upDocId" th:value="${doc.id}"/>
                                            <a href="javascript:void(0)"
                                               th:onclick="'javascript:toViewUploadDoc(\''+${doc.fileName}+'\',\''+${doc.url}+'\')'">
                                                <span class="corner"></span>

                                                <div class="icon">
                                                    <i class="fa fa-file"></i>
                                                </div>
                                                <div class="file-name">
                                                    <span th:text="${doc.fileName}"/>
                                                    <br/>
                                                    <small>添加时间：<span
                                                            th:text="${#dates.format(doc.created,'yyyy-MM-dd')}"></span>
                                                    </small>
                                                </div>
                                            </a>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <div class="col-sm-offset-3 col-sm-8">
                                <button class="btn btn-primary " type="submit" >提交</button>
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                <button class="btn btn-primary " type="button">取消</button>
                            </div>
                        </div>


                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<div th:include="include::footer"></div>

<script type="text/javascript" src="/js/appjs/act/award/publish_award_task_edit.js"></script>

<script type="text/javascript">
    $(".i-checks").iCheck({checkboxClass: "icheckbox_square-green", radioClass: "iradio_square-green",});
    var editor = new Simditor({textarea: $("#editor"), defaultImage: "img/a9.jpg"})
    var asUid = $("#associationUid").val();
    $('#associationUserId').selectpicker('val', asUid);//设置选中
    $('#associationUserId').selectpicker('refresh');
    var task_start_time = {
        elem: "#task_start_time",
        format: "YYYY-MM-DD hh:mm",
        min: '1900-01-01 00:00:00',
        max: "2099-06-16 23:59:59",
        istime: true,
        istoday: false,
        choose: function (datas) {
            end.min = datas;
            end.start = datas
        }
    };

    var task_end_time = {
        elem: "#task_end_time",
        format: "YYYY-MM-DD hh:mm",
        min: '1900-01-01 00:00:00',
        max: "2099-06-16 23:59:59",
        istime: true,
        istoday: false,
        choose: function (datas) {
            start.max = datas
        }
    };
    laydate(task_start_time);
    laydate(task_end_time);

    var check_start_time = {
        elem: "#check_start_time",
        format: "YYYY-MM-DD hh:mm",
        min: '1900-01-01 00:00:00',
        max: "2099-06-16 23:59:59",
        istime: true,
        istoday: false,
        choose: function (datas) {
            end.min = datas;
            end.start = datas
        }
    };

    var check_end_time = {
        elem: "#check_end_time",
        format: "YYYY-MM-DD hh:mm",
        min: '1900-01-01 00:00:00',
        max: "2099-06-16 23:59:59",
        istime: true,
        istoday: false,
        choose: function (datas) {
            start.max = datas
        }
    };
    laydate(check_start_time);
    laydate(check_end_time);

    var expert_start_time = {
        elem: "#expert_start_time",
        format: "YYYY-MM-DD hh:mm",
        min: '1900-01-01 00:00:00',
        max: "2099-06-16 23:59:59",
        istime: true,
        istoday: false,
        choose: function (datas) {
            end.min = datas;
            end.start = datas
        }
    };

    var expert_end_time = {
        elem: "#expert_end_time",
        format: "YYYY-MM-DD hh:mm",
        min: '1900-01-01 00:00:00',
        max: "2099-06-16 23:59:59",
        istime: true,
        istoday: false,
        choose: function (datas) {
            start.max = datas
        }
    };


    laydate(expert_start_time);
    laydate(expert_end_time);

    var expert_start_time_second = {
        elem: "#expert_start_time_second",
        format: "YYYY-MM-DD hh:mm",
        min: '1900-01-01 00:00:00',
        max: "2099-06-16 23:59:59",
        istime: true,
        istoday: false,
        choose: function (datas) {
            end.min = datas;
            end.start = datas
        }
    };

    var expert_end_time_second = {
        elem: "#expert_end_time_second",
        format: "YYYY-MM-DD hh:mm",
        min: '1900-01-01 00:00:00',
        max: "2099-06-16 23:59:59",
        istime: true,
        istoday: false,
        choose: function (datas) {
            start.max = datas
        }
    };
    laydate(expert_start_time_second);
    laydate(expert_end_time_second);


    function toViewUploadDoc(fileName, url) {
        parent.layer.open({
            type: 2,
            title: fileName,
            maxmin: true,
            shadeClose: false, // 点击遮罩关闭层
            area: ['800px', '520px'],
            content: url  // iframe的url
        });
    }

</script>

</body>
</html>
