<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">


<!-- Mirrored from www.zi-han.net/theme/hplus/file_manager.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 20 Jan 2016 14:19:44 GMT -->

<head th:include="include :: header"></head>


<body class="gray-bg">
<input type="hidden" id="isReadonly" th:value="${readonly}">
<input id="taskId" name="taskId" th:value="${taskId}"  type="hidden">

    <div class="wrapper wrapper-content">
        <div class="row">
            <div id="specialist_docs" class="updocss_b col-sm-12">
                <div class="ibox float-e-margins">
                    <div class="ibox-content">
                        <button class="btn btn-primary btn-block" fileType="specialist_docs">上传文件</button>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <div th:each="doc:${docUploadDoList}" class="file-box">
                            <div class="file">
                                <a href="javascript:void(0)" th:onclick= "'javascript:toViewUploadDoc(\''+${doc.fileName}+'\',\''+${doc.fileUrl}+'\')'">
                                    <span class="corner"></span>

                                    <div class="icon">
                                        <i class="fa fa-file"></i>
                                    </div>
                                    <div class="file-name">
                                        <span th:text="${doc.fileName}"/>
                                        <br/>
                                        <small>添加时间：<span th:text="${#dates.format(doc.created,'yyyy-MM-dd')}"></span></small>
                                    </div>
                                </a>
                                <div class="ui two buttons">
                                    <div class="ui bottom attached button" th:onclick="'javascript:toViewUploadDoc(\''+${doc.fileName}+'\',\''+${doc.fileUrl}+'\')'"><i class="eye icon"></i> 查看 </div>
                                    <div class="ui bottom attached button" th:onclick="'javascript:removeUploadDoc(this,'+${doc.fileId}+')'"><i class="trash alternate outline icon"></i> 删除 </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div th:include="include :: footer"></div>
    <script src="/js/layui.js"></script>
    <script type="text/javascript" src="/js/appjs/cpe/qc/qc_file_common.js"></script>
    <script type="text/javascript" src="/js/appjs/cpe/common/readonly.js"></script>

    <script>
        $(document).ready(function() {
            $(".file-box").each(function() {
                animationHover(this, "pulse")
            })

            $(".btn-block").on("click",function () {
                 parent.layer.open({
                     zIndex:110,
         	    	type : 2,
         	    	title : '上传附件资料',
         	    	maxmin : true,
         	    	shadeClose : false, // 点击遮罩关闭层
         	    	area : [ '800px', '520px' ],
         	    	content : '/specialistDoc/toUploadDoc?taskId='+$("#taskId").val()
         	    });
             });

        });

        function showUpload(upId, cssType) {
            console.log("-----aaaa>showUpload=", upId, $("#" + upId));
            $(".updocss_" + cssType).attr('style', 'display:none');
            $("#" + upId).attr('style', 'display:block');
        }

        function toViewUploadDoc(fileName,url) {
            parent.layer.open({
                type : 2,
                title : fileName,
                maxmin : true,
                shadeClose : false, // 点击遮罩关闭层
                area : [ '800px', '520px' ],
                content : url  // iframe的url
            });
        }

        /***
         * 删除文件
         * @param id
         */
        function removeUploadDoc(that,id){
            layer.confirm('确定要删除选中的记录？', {
                btn : [ '确定', '取消' ]
            }, function() {
                $.ajax({
                    cache: true,
                    type: "POST",
                    url: "/specialistDoc/removeDoc",
                    data: {
                        id:id
                    },
                    async: false,
                    error: function (request) {
                        parent.layer.alert("Connection error");
                    },
                    success: function (data) {
                        if (data.code == 0) {
                            $(that).parent().parent().parent().remove();
                        }
                        layer.msg(data.msg);
                    }
                });
            })
        }
    </script>
</body>



</html>
