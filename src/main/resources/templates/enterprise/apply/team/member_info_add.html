<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">
<meta charset="utf-8">
<head th:include="include::header"></head>
<body>
<div class="ui top attached tabular menu">
    <a href="#" class="active item">新增 </a>
    <!--
        <a th:href="@{/chengguo_team/members_print(proId=${proId},taskId=${taskId},applyId=${applyId})}" class="item">打印 </a>
    -->
</div>
<div class="ui bottom attached segment">
    <form action="" class="ui form" id="memberCountForm">
        <input id="id" name="id" th:value="${enterpriTeamUsers.id}" type="hidden" />
        <input name="proId" th:value="${proId}" type="hidden" />
        <input name="taskId" th:value="${taskId}" type="hidden" />
        <input name="applyId" th:value="${applyId}" type="hidden" />
        <input id="isReadonly" th:value="${readonly}" type="hidden" />
        <h4 class="ui red horizontal divider header">基本信息 </h4>
        <div class="ui field">
            <label>总人数</label>
            <input type="text" name="totalCount" th:value="${enterpriTeamUsers.totalCount}" placeholder="总人数">
        </div>
        <div class="ui two fields">
            <div class="ui field">
                <label>男士人数</label>
                <input type="text" name="manCount" th:value="${enterpriTeamUsers.manCount}" placeholder="男士人数">
            </div>
            <div class="ui field">
                <label>女士人数</label>
                <input type="text" name="womanCount" th:value="${enterpriTeamUsers.womanCount}" placeholder="女士人数">
            </div>
        </div>
        <h4 class="ui red horizontal divider header">年龄结构 </h4>
        <div class="ui two fields">
            <div class="ui two  field">
                <label>65周岁以上(%)</label>
                <input type="text" name="ageBeyond65Count" th:value="${enterpriTeamUsers.ageBeyond65Count}"
                       placeholder="65周岁以上(%)">
                <input type="text" name="ageBeyond65CountNum" th:value="${enterpriTeamUsers.ageBeyond65CountNum}"
                       placeholder="65周岁以上(人)">
            </div>
            <div class="ui two  field">
                <label>50-65周岁(%)</label>
                <input type="text" name="age50To65Count" th:value="${enterpriTeamUsers.age50To65Count}"
                       placeholder="50-65周岁(%)">

                <input type="text" name="age50To65CountNum" th:value="${enterpriTeamUsers.age50To65CountNum}"
                       placeholder="50-65周岁(人)">
            </div>
        </div>
        <div class="ui two fields">
            <div class="ui two  field">
                <label>35-50周岁(%)</label>
                <input type="text" name="age35To50Count" th:value="${enterpriTeamUsers.age35To50Count}"
                       placeholder="35-50周岁(%)">

                <input type="text" name="age35To50CountNum" th:value="${enterpriTeamUsers.age35To50CountNum}"
                       placeholder="35-50周岁(人)">
            </div>
            <div class="ui two  field">
                <label>35周岁以下(%)</label>
                <input type="text" name="ageUnder36Count" th:value="${enterpriTeamUsers.ageUnder36Count}"
                       placeholder="35周岁以下(%)">
                <input type="text" name="ageUnder36CountNum" th:value="${enterpriTeamUsers.ageUnder36CountNum}"
                       placeholder="35周岁以下(人)">
            </div>
        </div>
        <h4 class="ui red horizontal divider header">专业技术职务 </h4>
        <div class="ui three fields">
            <div class="ui field">
                <label>正高级(%)</label>
                <input type="text" name="positionSenior" th:value="${enterpriTeamUsers.positionSenior}"
                       placeholder="正高级(%)">
                <input type="text" name="positionSeniorNum" th:value="${enterpriTeamUsers.positionSeniorNum}"
                       placeholder="正高级(人)">
            </div>
            <div class="ui field">
                <label>副高级(%)</label>
                <input type="text" name="positionDeputySenior" th:value="${enterpriTeamUsers.positionDeputySenior}"
                       placeholder="副高级(%)">
                <input type="text" name="positionDeputySeniorNum" th:value="${enterpriTeamUsers.positionDeputySeniorNum}"
                       placeholder="副高级(人)">
            </div>
            <div class="ui field">
                <label>中级(%)</label>
                <input type="text" name="positionIntermediate" th:value="${enterpriTeamUsers.positionIntermediate}"
                       placeholder="中级(%)">

                <input type="text" name="positionIntermediateNum" th:value="${enterpriTeamUsers.positionIntermediateNum}"
                       placeholder="中级(人)">

            </div>
        </div>
        <h4 class="ui red horizontal divider header">学历 </h4>
        <div class="ui three fields">
            <div class="ui field">
                <label>博士研究生(%)</label>
                <input type="text" name="eduDoctoralCandidate" th:value="${enterpriTeamUsers.eduDoctoralCandidate}"
                       placeholder="博士研究生(%)">
                <input type="text" name="eduDoctoralCandidateNum"  th:value="${enterpriTeamUsers.eduDoctoralCandidateNum}"
                       placeholder="博士研究生(人)">
            </div>
            <div class="ui field">
                <label>硕士研究生(%)</label>
                <input type="text" name="eduPostgraduates" th:value="${enterpriTeamUsers.eduPostgraduates}"
                       placeholder="硕士研究生(%)">
                <input type="text" name="eduPostgraduatesNum" th:value="${enterpriTeamUsers.eduPostgraduatesNum}"
                       placeholder="硕士研究生(人)">
            </div>
            <div class="ui field">
                <label>本科(%)</label>
                <input type="text" name="eduUndergraduate" th:value="${enterpriTeamUsers.eduUndergraduate}"
                       placeholder="本科(%)">
                <input type="text" name="eduUndergraduateNum" th:value="${enterpriTeamUsers.eduUndergraduateNum}"
                       placeholder="本科(人)">
            </div>
        </div>
        <div class="ui error message"></div>
        <div class="ui basic center aligned segment">
            <button class="ui button" onclick="saveMemberBaseInfo()">保存</button>
        </div>
    </form>

</div>
<div th:include="include::footer"></div>
<script src="/js/appjs/cpe/common/readonly.js" type="text/javascript"></script>

<script>
    $('.ui.dropdown').dropdown();

    function viewUserInfo(id,userType) {
        $.ajax({
            cache : true,
            type : "GET",
            url : "/system/enterpriTeamUsersList/get?id="+id,
            dataType:"json",
            data : "",// 你的formid
            async : false,
            error : function(request) {
                parent.layer.alert("Connection error");
            },
            success : function(data) {
                if (data.code == 0) {
                    parent.layer.msg("操作成功");
                    console.log("测试");

                    if (userType == "leader"){
                        $('#submit_team_user').hide();
                    }else {
                        $('#submit_team_user').show();
                    }

                    var userInfo = data.userInfo;
                    $("#form_"+userType).find("input[name='id']").val(id)
                    $("#form_"+userType).find("input[name='userName']").val(userInfo.userName);
                    $("#form_"+userType).find("input[name='gender']").val(userInfo.gender);
                    $("#form_"+userType).find("input[name='age']").val(userInfo.age);
                    $("#form_"+userType).find("input[name='technicalPosition']").val(userInfo.technicalPosition);
                    $("#form_"+userType).find("input[name='workCompany']").val(userInfo.workCompany);
                    $("#form_"+userType).find("input[name='researchField']").val(userInfo.researchField);
                    $("#form_"+userType).find("input[name='teamWorkTimeLen']").val(userInfo.teamWorkTimeLen);
                } else {
                    parent.layer.alert(data.msg)
                }

            }
        });
    }

   function viewUserInfoModify(id,userType){
       $.ajax({
           cache : true,
           type : "GET",
           url : "/system/enterpriTeamUsersList/get?id="+id,
           dataType:"json",
           data : "",// 你的formid
           async : false,
           error : function(request) {
               parent.layer.alert("Connection error");
           },
           success : function(data) {
               if (data.code == 0) {
                   parent.layer.msg("操作成功");
                   console.log("测试");

                  $('#submit_team_user').show();

                   var userInfo = data.userInfo;
                   $("#form_"+userType).find("input[name='id']").val(id)
                   $("#form_"+userType).find("input[name='userName']").val(userInfo.userName);
                   $("#form_"+userType).find("input[name='gender']").val(userInfo.gender);
                   $("#form_"+userType).find("input[name='age']").val(userInfo.age);
                   $("#form_"+userType).find("input[name='technicalPosition']").val(userInfo.technicalPosition);
                   $("#form_"+userType).find("input[name='workCompany']").val(userInfo.workCompany);
                   $("#form_"+userType).find("input[name='researchField']").val(userInfo.researchField);
                   $("#form_"+userType).find("input[name='teamWorkTimeLen']").val(userInfo.teamWorkTimeLen);
               } else {
                   parent.layer.alert(data.msg)
               }

           }
       });
   }

    function delUserInfo(id,userType) {
        $.ajax({
            cache : true,
            type : "POST",
            url : "/system/enterpriTeamUsersList/remove",
            data : {
                id:id
            },// 你的formid
            dataType:"json",
            async : false,
            error : function(request) {
                parent.layer.alert("Connection error");
            },
            success : function(data) {
                if (data.code == 0) {
                    parent.layer.msg("操作成功");
                    window.location.reload();
                } else {
                    parent.layer.alert(data.msg)
                }

            }
        });
    }


    function submitTeamUser(userType) {
        $.ajax({
            cache : true,
            type : "POST",
            url : "/system/enterpriTeamUsersList/save",
            data : $("#form_"+userType).serialize(),// 你的formid
            async : false,
            error : function(request) {
                parent.layer.alert("Connection error");
            },
            success : function(data) {
                if (data.code == 0) {
                    parent.layer.msg("操作成功");
                } else {
                    parent.layer.alert(data.msg)
                }

            }
        });

    }

    function saveMemberBaseInfo() {
        $.ajax({
            cache: true,
            type: "POST",
            url: "/system/enterpriTeamUsers/save",
            data: $('#memberCountForm').serialize(),// 你的formid
            async: false,
            error: function (request) {
                parent.layer.alert("Connection error");
            },
            success: function (data) {
                if (data.code == 0) {
                    parent.layer.msg("操作成功");
                } else {
                    parent.layer.alert(data.msg)
                }

            }
        });
    }

    $('.ui.form').form({
        on: 'blur',
        fields: {
            totalCount: {
                identifier: 'totalCount',
                rules: [
                    {
                        type: 'integer',
                        prompt: '请填写总人数,且为阿拉伯数字'
                    }
                ]
            },
            manCount: {
                identifier: 'manCount',
                rules: [
                    {
                        type: 'integer',
                        prompt: '请填写男人数量,且为阿拉伯数字'
                    }
                ]
            },
            womanCount: {
                identifier: 'womanCount',
                rules: [
                    {
                        type: 'integer',
                        prompt: '请填写女人数量,且为阿拉伯数字'
                    }
                ]
            },
            ageBeyond65Count: {
                identifier: 'ageBeyond65Count',
                rules: [
                    {
                        type: 'integer[0..100]',
                        prompt: '请填写年龄结构-65周岁以上人员所占比例,且为0至100的阿拉伯数字'
                    }
                ]
            },
            age50To65Count: {
                identifier: 'age50To65Count',
                rules: [
                    {
                        type: 'integer[1..100]',
                        prompt: '请填写年龄结构-50-65周岁人员所占比例,且为0至100的阿拉伯数字'
                    }
                ]
            },
            age35To50Count: {
                identifier: 'age35To50Count',
                rules: [
                    {
                        type: 'integer[0..100]',
                        prompt: '请填写年龄结构-35-50周岁人员所占比例,且为0至100的阿拉伯数字'
                    }
                ]
            },
            ageUnder36Count: {
                identifier: 'ageUnder36Count',
                rules: [
                    {
                        type: 'integer[0..100]',
                        prompt: '请填写年龄结构-35周岁以下人员所占比例,且为0至100的阿拉伯数字'
                    }
                ]
            },
            positionSenior: {
                identifier: 'positionSenior',
                rules: [
                    {
                        type: 'integer[0..100]',
                        prompt: '请填写专业技术职务-正高级所占比例,且为0至100的阿拉伯数字'
                    }
                ]
            },
            positionDeputySenior: {
                identifier: 'positionDeputySenior',
                rules: [
                    {
                        type: 'integer[0..100]',
                        prompt: '请填写专业技术职务-副高级所占比例,且为0至100的阿拉伯数字'
                    }
                ]
            },
            positionIntermediate: {
                identifier: 'positionIntermediate',
                rules: [
                    {
                        type: 'integer[0..100]',
                        prompt: '请填写专业技术职务-中级所占比例,且为0至100的阿拉伯数字'
                    }
                ]
            },
            eduDoctoralCandidate: {
                identifier: 'eduDoctoralCandidate',
                rules: [
                    {
                        type: 'integer[0..100]',
                        prompt: '请填写学历-博士研究生所占比例,且为0至100的阿拉伯数字'
                    }
                ]
            },
            eduPostgraduates: {
                identifier: 'eduPostgraduates',
                rules: [
                    {
                        type: 'integer[0..100]',
                        prompt: '请填写学历-硕士研究生所占比例,且为0至100的阿拉伯数字'
                    }
                ]
            },
            eduUndergraduate: {
                identifier: 'eduUndergraduate',
                rules: [
                    {
                        type: 'integer[0..100]',
                        prompt: '请填写学历-本科所占比例,且为0至100的阿拉伯数字'
                    }
                ]
            },
            userName: {
                identifier: 'userName',
                rules: [
                    {
                        type: 'empty',
                        prompt: '请填写姓名'
                    }
                ]
            },
            gender: {
                identifier: 'gender',
                rules: [
                    {
                        type: 'empty',
                        prompt: '请填写性别'
                    }
                ]
            },
            age: {
                identifier: 'age',
                rules: [
                    {
                        type: 'integer',
                        prompt: '请填写年龄,且为阿拉伯数字'
                    }
                ]
            },
            technicalPosition: {
                identifier: 'technicalPosition',
                rules: [
                    {
                        type: 'empty',
                        prompt: '请填写专业技术职务'
                    }
                ]
            },
            workCompany: {
                identifier: 'workCompany',
                rules: [
                    {
                        type: 'empty',
                        prompt: '请填写所在单位'
                    }
                ]
            },
            researchField: {
                identifier: 'researchField',
                rules: [
                    {
                        type: 'empty',
                        prompt: '请填写研究领域'
                    }
                ]
            },
            teamWorkTimeLen: {
                identifier: 'teamWorkTimeLen',
                rules: [
                    {
                        type: 'integer',
                        prompt: '请填写团队工作时间（年）,且为阿拉伯数字'
                    }
                ]
            }
        }
    });
</script>

</body>
</html>